<!DOCTYPE html>
<html>
    
    <head>
        <meta charset="utf-8">
    
        <title>GETTING STARTED WITH BRACKETS</title>
        <meta name="description" content="An interactive getting started guide for Brackets.">
       <link rel="stylesheet" href="style.css">
  
        <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.4/jquery.mobile-1.4.4.min.css">

    </head>
    <body>
       
        
    <h1 class="center">Tinder For Food</h1>
        

    <div id="container">

        <div class="buddy"  id="buddy1" style="display: block;">
            <div id ="avatar1" class="avatar" style="display: block;"><img id = "avatar1Pic" src=""/></div>
            <div class="info">

                <div class = "cuisineType">0</div>

            </div>
        </div>
        
    
        <div class="buddy" id="buddy2" style="display: block;">
            <div id ="avatar2" style="display: block;"><img id = "avatar2Pic" src=""/></div>
                <div class="info">


                </div>
            </div>
        
        <div class = "restaurantBlocks" id = "restaurant1">
            <div class = "restImg" id = "restDiv1"><img id = "restImg1" /></div>
                <h2 class = "restaurantName"></h2>
                <div class = "cuisineType">0</div>
                <div class = "rating"></div>
                <div class = "priceRange"></div>
        </div>
        <div class = "restaurantBlocks" id = "restaurant2">
            <div class = "restImg" id = "restDiv2"><img id = "restImg2" /></div>
                <h2 class = "restaurantName"></h2>
                 <div class = "cuisineType">0</div>
                 <div class = "rating"></div>
                 <div class = "priceRange"></div>

        </div>

    </div>

        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
        <script src="https://code.jquery.com/mobile/1.4.4/jquery.mobile-1.4.4.min.js"></script>
        <script>
            $(window).on('touchstart',function(e){e.preventDefault()});
            
            $(document).ready(function(){

            $(".restaurantBlocks").hide();
                
            $(".restaurantBlocks").on("swiperight",function(){
                console.log("rest swiped right");
                //1. swipe right animation
                //2. hide all restarants
                //3. show rest data
            });
            $(".restaurantBlocks").on("swipeleft",function(e){
                //1. get the next data
                // 2. populate data to next div
                //3. hide this div
                //4. show other div
                
                var swipedAwayId=e.delegateTarget.id;
                var otherDiv=document.querySelector(".restaurantBlocks:not(#"+swipedAwayId+")");
                console.log(swipedAwayId);
                console.log(otherDiv);
                
                updateRestaurants(otherDiv);
                
                 $(this).addClass('rotate-right').delay(700).fadeOut(1);
                $(otherDiv).removeClass('rotate-left rotate-right').fadeIn(300);
                
            });
                
            $(".buddy").on("swiperight",function(){
                
               
                  $(this).addClass('rotate-left').delay(700).fadeOut(1,function(){
                      $(".buddy").hide();
                      console.log("buddy swiped right");
                      $(".restaurantBlocks").fadeIn();
                      //load data, shiw the first one
                      
                      
                  });
                  $('.buddy').find('.status').remove();

                  $(this).append('<div class="status like">Like!</div>'); 
                /*
                  if ( $(this).is(':last-child') ) {
                    $('.buddy:nth-child(1)').removeClass ('rotate-left rotate-right').fadeIn(300);
                   } else {
                      $(this).next().removeClass('rotate-left rotate-right').fadeIn(400);
                   }*/
            });  
                
            $(".buddy").on("swipeleft",function(e){
                var src=updataImage();
                var swipedAwayId=e.delegateTarget.id;
                
                console.log("nextImageSrc",src);
                console.log("myID",swipedAwayId);
                console.log("me",e.target);
                
                var theOtherBuddy=document.querySelector(".buddy:not(#"+swipedAwayId+")");
                $(theOtherBuddy).removeClass('rotate-left rotate-right').fadeIn(300);
                theOtherImg=$(theOtherBuddy).find("img");
                console.log("theOtherImg",theOtherImg);
                theOtherImg.attr("src",src);

                $(this).addClass('rotate-right').delay(700).fadeOut(1);
                $('.buddy').find('.status').remove();
                $(this).append('<div class="status dislike">Dislike!</div>');
                /*
                if ( $(this).is(':last-child') ) {                    
                 $('.buddy:nth-child(1)').removeClass('rotate-left rotate-right').fadeIn(300); 
                 } else {
                    $(this).next().removeClass('rotate-left rotate-right').fadeIn(400);
                } */
                
              });

            });

            
            var divAnimationToggle = true;
            var cuisineCount = -1;
            var cuisine = [];       //array holding the cuisines
            var imageLink = [];     //array containting the image link to the cuisines
            console.log(imageLink);
            var currentCuisine = "";
            d3.csv("foodTinder - Cuisine.csv",function(csv){
                    csv.map(function(d){
                        cuisine.push(d.CuisineName);
                        imageLink.push(d.CuisineImageLink);
                    });
                updataImage();
            });
            function updataImage(){
                cuisineCount++;
            //    console.log("cuisineC",cuisineCount);
                currentCuisine = cuisine[cuisineCount];
        //        console.log(cuisine[cuisineCount]);
        //        console.log(currentCuisine);
        //        console.log(imageLink[cuisineCount]);
    //            var imageUrl = "url("+imageLink[cuisineCount]+")";
        //        console.log(imageUrl);
                return  imageLink[cuisineCount];
                /*
                if(divAnimationToggle){
                    
                    //document.getElementById("buddy1").style.display = "block";
                    document.getElementById("avatar1Pic").src = imageLink[cuisineCount];
                    //document.getElementById("buddy2").style.display = "none";
                    divAnimationToggle = false;
                    
                }else{
                    //document.getElementById("buddy1").style.display = "none";
                    document.getElementById("avatar2Pic").src =imageLink[cuisineCount];
                    //document.getElementById("buddy2").style.display = "block";
                    divAnimationToggle = true;
                    
                }*/
              //  document.getElementById("cuisineType").innerHTML =  currentCuisine;;
            }
            var allRestaurants = new Array(20);
            
            var chineseRestaurants = new Array(20);
            var italianRestaurants = new Array(20);
            d3.csv("foodTinder - Restaurant.csv",function(csv){
                
                var chineseIndexCount = 0;
                var attrCount = 0;
                
                var italianIndexCount = 0;
                csv.map(function(d){
                    if(d.Cuisine == "Chinese"){
                        chineseRestaurants[chineseIndexCount] = new Array(4);
                        chineseRestaurants[chineseIndexCount][attrCount] = d.RestaurantName;
                        attrCount++;
                        chineseRestaurants[chineseIndexCount][attrCount] = d.Rating;
                        attrCount++;
                        chineseRestaurants[chineseIndexCount][attrCount] = d.Price;
                        attrCount++;
                        chineseRestaurants[chineseIndexCount][attrCount] = d.RestaurantImageLink;
                        chineseIndexCount++;
                        attrCount = 0;
                    }else if(d.Cuisine == "Italian"){
                        italianRestaurants[italianIndexCount] = new Array(4);
                        italianRestaurants[italianIndexCount][attrCount] = d.RestaurantName;
                        attrCount++;
                        italianRestaurants[italianIndexCount][attrCount] = d.Rating;
                        attrCount++;
                        italianRestaurants[italianIndexCount][attrCount] = d.Price;
                        attrCount++;
                        italianRestaurants[italianIndexCount][attrCount] = d.RestaurantImageLink;
                        italianIndexCount++;
                        attrCount = 0;
                    }
                    
                })
            });
            
            allRestaurants[0] = chineseRestaurants;
            allRestaurants[1] = italianRestaurants;
            console.log(allRestaurants);
            var cuisineTypeIndex;
            function getRestaurants(){
                
                var cuisineTypes = ["Chinese","Italian","Korean", "Mediterranean", "American", "Cajun", "Greek", "Indian", "Thai", "Vietnamese"];
               
                for(i = 0; i < cuisineTypes.length; i++){
                    if(currentCuisine == cuisineTypes[i]){
                        cuisineTypeIndex = i;
                    }
                }
                console.log(currentCuisine+" cuisine selected, its cuisine index is "+cuisineTypeIndex);
                
                
            }
    
            
            
            restaurantsIndex = 0;
            function updateRestaurants(parentDiv){
                getRestaurants();
             //   console.log("resturant updating");
               // console.log(parentDiv);
            
                var imageUrl = "url("+allRestaurants[cuisineTypeIndex][restaurantsIndex][3]+")";
                    
                $(parentDiv).find(".restaurantName").text(allRestaurants[cuisineTypeIndex][restaurantsIndex][0]);
                $(parentDiv).find(".cuisineType").text(currentCuisine);
                $(parentDiv).find(".rating").text(allRestaurants[cuisineTypeIndex][restaurantsIndex][1]);
                $(parentDiv).find(".priceRange").text(allRestaurants[cuisineTypeIndex][restaurantsIndex][2]);
                 
                $(parentDiv).find("img").attr("src", allRestaurants[cuisineTypeIndex][restaurantsIndex][3]);
                
               // document.getElementById("avatar").style.backgroundImage=imageUrl;
                

                restaurantsIndex++;
                
            }
             
            
            
        </script>
             
       

    </body>
</html>

